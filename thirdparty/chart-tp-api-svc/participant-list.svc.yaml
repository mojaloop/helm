##
# The following is values.yaml file for a ttk that
# mocks out the participant-list-svc features for
# the 3P API
#
# The actual config for the /services/{Type} API comes from an external repo: 
# https://github.com/vessels-tech/ml-oss-sandbox This is a workaround because 
# we can't specify inline TTK configs from within this values file. 
##

COMPUTED VALUES:
connection-manager-backend:
  enabled: false
connection-manager-frontend:
  enabled: false
global: {}
keycloak:
  enabled: false
ml-testing-toolkit-backend:
  affinity: {}
  config:
    system_config.json:
      API_DEFINITIONS:
      - asynchronous: true
        folderPath: fspiop_1.0
        type: fspiop
        version: "1.0"
      - asynchronous: true
        folderPath: fspiop_1.1
        type: fspiop
        version: "1.1"
      - folderPath: settlements_1.0
        type: settlements
        version: "1.0"
      - folderPath: central_admin_9.3
        type: central_admin
        version: "9.3"
      - folderPath: als_admin_1.1
        type: als_admin
        version: "1.1"
      API_PORT: 5000
      CONFIG_VERSIONS:
        callback: 1
        forward: 1
        response: 1
        userSettings: 1
        validation: 1
      CONNECTION_MANAGER:
        API_URL: http://$connection_manager_host:$connection_manager_port
        AUTH_ENABLED: false
        HUB_PASSWORD: hub
        HUB_USERNAME: hub
      CONNECTION_MANAGER_AUTH_ENABLED: false
      DB:
        URI: mongodb://ttk:ttk@$mongodb_host:$mongodb_port/ttk
      HOSTING_ENABLED: false
      KEYCLOAK:
        API_URL: http://$auth_host:$auth_port
        ENABLED: false
        PASSWORD: hub
        REALM: testingtoolkit
        USERNAME: hub
      OAUTH:
        APP_OAUTH_CLIENT_KEY: ttk
        APP_OAUTH_CLIENT_SECRET: 23b898a5-63d2-4055-bbe1-54efcda37e7d
        AUTH_ENABLED: false
        EMBEDDED_CERTIFICATE: $auth_embedded_certificate
        EVERYONE_ROLE: Internal/everyone
        JWT_COOKIE_NAME: TTK-API_ACCESS_TOKEN
        MTA_ROLE: Application/MTA
        OAUTH2_ISSUER: http://$auth_host:$auth_port$auth_issuer_path
        OAUTH2_TOKEN_ISS: http://$auth_host:$auth_port$auth_token_iss_path
        P12_PASS_PHRASE: SOME_S3C4R3_P@SS
        PTA_ROLE: Application/PTA
    user_config.json:
      ADVANCED_FEATURES_ENABLED: true
      # Endpoint of FSPIOP API... I think
      CALLBACK_ENDPOINT: http://beta.moja-lab.live/api/fspiop
      CALLBACK_RESOURCE_ENDPOINTS:
        enabled: true
        endpoints:
        - endpoint: http://moja-account-lookup-service.demo
          method: put
          path: /parties/{Type}/{ID}
        - endpoint: http://moja-quoting-service.demo
          method: put
          path: /quotes/{ID}
        - endpoint: http://moja-ml-api-adapter-service.demo
          method: put
          path: /transfers/{ID}
      CALLBACK_TIMEOUT: 10000
      DEFAULT_USER_FSPID: userdfsp
      ENDPOINTS_DFSP_WISE:
        dfsps:
          userdfsp:
            defaultEndpoint: http://mojaloop-sim-switch-scheme-adapter:4000
            endpoints: []
          userdfsp2:
            defaultEndpoint: http://scheme-adapter2:4000
            endpoints: []
      FSPID: swich
      HUB_ONLY_MODE: false
      ILP_SECRET: secret
      INBOUND_MUTUAL_TLS_ENABLED: false
      JWS_SIGN: false
      JWS_SIGN_PUT_PARTIES: false
      OUTBOUND_MUTUAL_TLS_ENABLED: false
      SEND_CALLBACK_ENABLE: true
      TRANSFERS_VALIDATION_CONDITION: true
      TRANSFERS_VALIDATION_ILP_PACKET: true
      TRANSFERS_VALIDATION_WITH_PREVIOUS_QUOTES: true
      VALIDATE_INBOUND_JWS: false
      VALIDATE_INBOUND_PUT_PARTIES_JWS: false
      VERSION: 1
      VERSIONING_SUPPORT_ENABLE: true
  dependencies:
    adminApiAuthentication:
      embeddedCertificate: password
      host: localhost
      paths:
        issuer: /api/oauth2/token
        tokenIss: /api/oauth2/token
      port: "5050"
    connectionManagerBackend:
      enabled: false
      host: $release_name-connection-manager-backend
      port: "5061"
    keycloak:
      embeddedCertificate: '-----BEGIN PUBLIC KEY-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDda1T6cyWogfG/xlUb3+gWZI0jsnlSGbf3PF89NCgS+n6HUJ0A2Ezmu/n9Gfkm8Rjyst914Vq9ebsueXHIc+Ad76+q3MASF1hRUTfnvH/v6rDguPvI6Jb/M9jGn5b2hglcg3B9Y7Tgv70bcV7oCweP68CPbIrTWjR9gyjmSHfYhwIDAQAB\n-----END
        PUBLIC KEY-----'
      enabled: false
      host: $release_name-keycloak-http
      paths:
        issuer: /auth/realms/testingtoolkit/protocol/openid-connect/token
        tokenIss: /auth/realms/testingtoolkit
      port: "7080"
    mongodb:
      enabled: false
      host: $release_name-ttk-mongodb
      port: "27017"
  enabled: true
  extraEnvironments: {}
  global: {}
  image:
    tag: v13.1.0
    # Load some config from ml-oss-sandbox master branch
    # hopefully soon we will have a better way to load
    # apis into the TTK
    command: >
      ["sh", "-c", 
        "BRANCH_NAME=master;
        REPO_URL=https://github.com/vessels-tech/ml-oss-sandbox/archive/master.zip;
        SRC_CONFIG_PATH=/tmp/pisp/ml-oss-sandbox-master/config/switch/thirdparty/tp-svc/spec_files;
        DEST_CONFIG_PATH=/opt/mojaloop-testing-toolkit/spec_files;
        mkdir -p /tmp/pisp;
        wget ${REPO_URL} -O /tmp/pisp.zip;
        unzip /tmp/pisp.zip -d /tmp/pisp;
        ls ${SRC_CONFIG_PATH};
        rm -rf ${DEST_CONFIG_PATH};
        cp -R ${SRC_CONFIG_PATH} ${DEST_CONFIG_PATH};
        npm run start;
        "
      ]
    pullPolicy: Always
  ingress:
    annotations: {}
    enabled: false
    hosts:
      testing-toolkit-specapi.local:
        paths:
        - /
        port: 5000
      testing-toolkit.local:
        paths:
        - /api/
        - /socket.io/
        port: 5050
    tls: []
  livenessProbe:
    enabled: false
    httpGet:
      path: /health
    initialDelaySeconds: 90
    periodSeconds: 15
  nodeSelector: {}
  persistence:
    accessMode: ReadWriteOnce
    enabled: false
    size: 1Gi
  readinessProbe:
    enabled: false
    httpGet:
      path: /health
    initialDelaySeconds: 120
    periodSeconds: 15
  replicaCount: 1
  resources: {}
  service:
    ports:
      adminApi:
        externalPort: 5050
        internalPort: 5050
        name: admin-api
      specApi:
        externalPort: 5000
        internalPort: 5000
        name: spec-api
    type: ClusterIP
  tolerations: []
ml-testing-toolkit-frontend:
  enabled: false
mysql:
  enabled: false